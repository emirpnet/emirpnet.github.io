<!DOCTYPE html>
<html lang="en">

<!--
/*
 * ibancheck.js
 * Version: 0.2.1
 * Author: Jochen Peters
 * http://www.emirp.net/
 *
 * IBANs for testing (see below) from: http://toms-cafe.de/iban/iban.js
 *
 * This is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * It is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * See <http://www.gnu.org/licenses/> for a copy of the GNU General
 * Public License.
 */
 //-->

<head>
<meta charset="utf-8">
<meta name="robots" content="noindex, nofollow">
<meta name="date" content="2024-10-14">
<title>IBAN check</title>

<script language="javascript" type="text/javascript">

"use strict";

function byId(id) { return document.getElementById(id); }

function on_load() {
	byId("iban").addEventListener("keypress", function(event) {
		if (event.key === "Enter") {
			event.preventDefault();
			byId("btn_check").click();
		}
	});
	reset();
}

function reset() {
	byId("iban").value = "";
	byId("iban").style.background = "#FFFFFF";
	byId("iban").focus();
	byId("result").innerHTML = "";
}

function on_input(input) {
	input = cleanup_input(input);

	if(input == "") {
		reset();
		return;
	}

	let valid = is_iban_valid(input);

	// show result
	if(valid) {
		byId("result").innerHTML = "&quot;" + input + "&quot; is valid.";
		byId("iban").style.background = "#00CC00";
	} else {
		byId("result").innerHTML = "&quot;" + input + "&quot; is INVALID!";
		byId("iban").style.background = "#CC0000";
	}
}

function cleanup_input(input) {
	return String(input).toUpperCase().replace(/[^A-Z0-9]/g, ''); // remvove all non-alphanumeric characters
}

function is_iban_valid(input) {
	input = cleanup_input(input);
	let iban = input.match(/^([A-Z]{2})(\d{2})([A-Z\d]+)$/);

	if(iban == null) {
		console.log("INVALID: input does not match IBAN syntax.");
		return false;
	}
	if(!is_length_valid(iban)) {
		console.log("INVALID: length is not correct.");
		return false;
	}
	if(!is_checksum_valid(iban)) {
		console.log("INVALID: checksum is not correct.");
		return false;
	}
	return true;
}

function is_length_valid(iban) {
	const CODE_LENGTHS = {
		"AD": 24, "AE": 23, "AL": 28, "AO": 25, "AT": 20, "AZ": 28, "BA": 20, "BE": 16, "BF": 27, "BG": 22, "BH": 22, "BI": 16, "BJ": 28, "BR": 29, "BY": 28, "CF": 27, "CG": 27, "CH": 21, "CI": 28, "CM": 27, "CR": 22, "CV": 25, "CY": 28, "CZ": 24, "DE": 22, "DK": 18, "DO": 28, "DZ": 24, "EE": 20, "EG": 29, "ES": 24, "FI": 18, "FO": 18, "FR": 27, "GA": 27, "GB": 22, "GE": 22, "GI": 23, "GL": 18, "GR": 27, "GT": 28, "HR": 21, "HU": 28, "IE": 22, "IL": 23, "IQ": 23, "IR": 26, "IS": 26, "IT": 27, "JO": 30, "KW": 30, "KZ": 20, "LB": 28, "LC": 32, "LI": 21, "LT": 20, "LU": 20, "LV": 21, "MC": 27, "MD": 24, "ME": 22, "MG": 27, "MK": 19, "ML": 28, "MR": 27, "MT": 31, "MU": 30, "MZ": 25, "NL": 18, "NO": 15, "PK": 24, "PL": 28, "PS": 29, "PT": 25, "QA": 29, "RO": 24, "RS": 22, "SA": 24, "SC": 31, "SE": 24, "SI": 19, "SK": 24, "SM": 27, "SN": 28, "ST": 25, "SV": 28, "TL": 23, "TN": 24, "TR": 26, "UA": 29, "VA": 22, "VG": 24, "XK": 20
	};
	if(CODE_LENGTHS[iban[1]] === undefined) {
		console.log("WARNING: country code \"" + iban[1] + "\" not found.");
		return false;
	}
	return iban[0].length == CODE_LENGTHS[iban[1]];
}

function is_checksum_valid(iban) {
	let digit_string = (iban[3] + iban[1] + iban[2]).replace(/[A-Z]/g, (c) => c.charCodeAt(0) - 55); // rearrange and convert chars to ints
	return mod97(digit_string) === 1;
}

function mod97(digit_string) {
	let checksum = digit_string.substring(0, 2);
	for(let pos = 2; pos < digit_string.length; pos += 7) {
		let current_string = String(checksum) + digit_string.substring(pos, pos + 7);
		checksum = parseInt(current_string, 10) % 97;
	}
	return checksum;
}

</script>

<style>

	html {
		touch-action: manipulation;
	}

	body {
		padding: 2%;
		margin: 0;
		color: white;
		font-family: sans-serif;
		background: #2196F3;
	}

	h1 {
		margin-bottom: 0;
		font-size: 2.5em;
		font-weight: bold;
	}

	h5 {
		margin: 0;
		font-size: 0.9em;
		font-weight: normal;
	}

	table {
		margin-top: 1em;
		width: 100%;
	}

	input {
		margin-bottom: 0.5em;
		width: 100%;
		text-align: left;
		font-size: 1.5em;
	}

	button {
		width: 100%;
		height: 2em;
		font-size: 1.5em;
		/*background: #BBDEFB;*/
	}

	#result {
		font-size: 1.5em;
	}
</style>

</head>
<body onload="on_load();">

<table>
<tr><td>IBAN: <input type="text" id="iban" /></td></tr>
<tr><td><button id="btn_check" onclick="on_input(document.getElementById('iban').value);">CHECK</button></td></tr>
<tr><td><button id="btn_reset" onclick="reset();">RESET</button></td></tr>
</table>
<p id="result"></p>

</body>
</html>
